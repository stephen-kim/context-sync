# =============================
# Context Sync Environment File
# =============================
# 1) 이 파일을 복사해서 .env 로 사용:
#    cp .env.example .env
#
# 1-1) Compose 파일 선택:
#    - 이미지 기반(운영/Dockge): docker compose up -d
#      (기본 파일: docker-compose.yml)
#    - 소스 빌드 기반(로컬 개발): docker compose -f docker-compose.dev.yml up -d
#
# 2) memory-core 앱은 DB 연결에 DATABASE_URL만 사용합니다.
#    POSTGRES_*는 localdb 프로파일에서 postgres 컨테이너 초기화용입니다.

# 이미지 기반 compose 앱 이미지 태그 (선택 override)
# - 미설정 시 기본값:
#   ghcr.io/stephen-kim/context-sync-*:latest
# - 커스텀 포크/조직 이미지를 쓸 때만 설정
# MEMORY_CORE_IMAGE=ghcr.io/<your-org>/context-sync-memory-core:latest
# MCP_ADAPTER_IMAGE=ghcr.io/<your-org>/context-sync-mcp-adapter:latest
# ADMIN_UI_IMAGE=ghcr.io/<your-org>/context-sync-admin-ui:latest

# -------------------------------------------------------------------
# Scenario A: local dev (docker compose --profile localdb up -d)
# - 컨테이너 내부에서 postgres 서비스명으로 접속해야 합니다.
# -------------------------------------------------------------------
DATABASE_URL=postgres://<db_user>:<db_password>@postgres:5432/<db_name>

# localdb 프로파일 postgres 컨테이너 초기화용 (dev only)
POSTGRES_DB=<db_name>
POSTGRES_USER=<db_user>
POSTGRES_PASSWORD=<db_password>

# -------------------------------------------------------------------
# Scenario B: external db (docker compose up -d)
# - 아래 값을 사용하도록 DATABASE_URL을 교체하세요.
# - RDS 등은 sslmode=require / verify-full 등을 포함할 수 있습니다.
# -------------------------------------------------------------------
# DATABASE_URL=postgres://<db_user>:<db_password>@<rds-endpoint>:5432/<db_name>?sslmode=require

# memory-core REST server bind
MEMORY_CORE_HOST=0.0.0.0
MEMORY_CORE_PORT=8080
MEMORY_CORE_LOG_LEVEL=error

# Optional: Slack audit forwarding webhook
# - If set, audit events are sent asynchronously to Slack (never blocks API response).
# - Use action prefixes to reduce noise (comma-separated), e.g.:
#   workspace_settings.,project_mapping.,integration.
# - Admin UI의 Slack Audit 설정이 있으면 workspace별 설정이 우선 적용됩니다.
MEMORY_CORE_AUDIT_SLACK_WEBHOOK_URL=
MEMORY_CORE_AUDIT_SLACK_ACTION_PREFIXES=
MEMORY_CORE_AUDIT_SLACK_DEFAULT_CHANNEL=
MEMORY_CORE_AUDIT_SLACK_FORMAT=detailed
MEMORY_CORE_AUDIT_SLACK_INCLUDE_TARGET_JSON=true
MEMORY_CORE_AUDIT_SLACK_MASK_SECRETS=true

# Optional: lock integration providers to env-only mode.
# - Default precedence: Admin UI workspace config > env fallback.
# - If provider is listed here, workspace config writes are blocked and env is forced.
# - Comma-separated: notion,jira,confluence,linear,slack
MEMORY_CORE_INTEGRATION_LOCKED_PROVIDERS=

# API key (memory-core REST auth)
MEMORY_CORE_API_KEY=<replace-with-strong-key>
MEMORY_CORE_API_KEYS=
MEMORY_CORE_SEED_ADMIN_KEY=<replace-with-seed-key>

# Notion integration (optional)
# - Set token to enable Notion read/search endpoints and MCP notion tools.
# - Write API is disabled by default; enable explicitly for merge-based docs sync.
# - Can be configured in Admin UI per-workspace even if these are empty.
MEMORY_CORE_NOTION_TOKEN=
MEMORY_CORE_NOTION_DEFAULT_PARENT_PAGE_ID=
MEMORY_CORE_NOTION_WRITE_ENABLED=false

# Jira integration (optional, read/search)
# - Atlassian Cloud example base URL: https://<your-org>.atlassian.net
# - Can be configured in Admin UI per-workspace even if these are empty.
MEMORY_CORE_JIRA_BASE_URL=
MEMORY_CORE_JIRA_EMAIL=
MEMORY_CORE_JIRA_API_TOKEN=

# Confluence integration (optional, read/search)
# - Base URL can be https://<your-org>.atlassian.net or .../wiki
# - Can be configured in Admin UI per-workspace even if these are empty.
MEMORY_CORE_CONFLUENCE_BASE_URL=
MEMORY_CORE_CONFLUENCE_EMAIL=
MEMORY_CORE_CONFLUENCE_API_TOKEN=

# Linear integration (optional, read/search)
# - API key header auth to Linear GraphQL endpoint
# - Can be configured in Admin UI per-workspace even if these are empty.
MEMORY_CORE_LINEAR_API_KEY=
# Optional override (default: https://api.linear.app/graphql)
MEMORY_CORE_LINEAR_API_URL=

# mcp-adapter -> memory-core (container 내부 주소)
# git hook forwarder(src/hook-event.ts)도 같은 값을 사용해 /v1/git-events 호출 가능
# (root context-sync에서 set_project(enable_git_hooks=true)로 설치된 hook에도 주입됨)
MEMORY_CORE_URL=http://memory-core:8080
MEMORY_CORE_WORKSPACE_KEY=personal
MCP_ADAPTER_LOG_LEVEL=error

# admin-ui public URL (브라우저에서 접근 가능한 memory-core 주소)
# 로컬 브라우저에서는 localhost 또는 도메인을 사용해야 합니다.
NEXT_PUBLIC_MEMORY_CORE_URL=http://localhost:8080
ADMIN_UI_PORT=3000
