# WHY – 과거 결정 관련

- id: why_postgres_migration
  persona: neutral
  q: "Why did we migrate from SQLite to Postgres?"
  expected:
    must_include_types: ["decision"]
    should_include_keywords: ["postgres", "sqlite", "migrate"]

- id: why_github_authority
  persona: architect
  q: "Why is GitHub the default authority for project permissions?"
  expected:
    must_include_types: ["decision", "constraint"]
    should_include_keywords: ["github", "authority", "permission"]

- id: why_append_only_audit
  persona: reviewer
  q: "Why is audit append-only?"
  expected:
    must_include_types: ["constraint"]
    should_include_keywords: ["append", "audit"]

# WHAT – 현재 상태/작업

- id: what_am_i_working_on
  persona: author
  q: "What am I working on right now?"
  expected:
    must_include_fields: ["active_work"]

- id: what_recent_changes
  persona: neutral
  q: "What changed recently in the GitHub permission system?"
  expected:
    should_include_types: ["activity", "decision"]

- id: what_global_rules
  persona: neutral
  q: "What are our global security rules?"
  expected:
    must_include_fields: ["global"]

# HOW – 구현/설계 방식

- id: how_permission_calculated
  persona: architect
  q: "How do we compute effective permissions from GitHub?"
  expected:
    must_include_types: ["decision"]
    should_include_keywords: ["max", "direct", "team"]

- id: how_context_bundle_works
  persona: architect
  q: "How does the context bundle get constructed?"
  expected:
    must_include_types: ["decision"]

- id: how_monorepo_split
  persona: architect
  q: "How does monorepo split_on_demand mode work?"
  expected:
    should_include_keywords: ["split_on_demand"]

# SECURITY

- id: security_permission_sync
  persona: reviewer
  q: "Are there any security risks in the GitHub permission sync?"
  expected:
    must_include_types: ["constraint"]

- id: security_api_keys
  persona: reviewer
  q: "How do we protect API keys?"
  expected:
    should_include_keywords: ["hash", "one-time"]

- id: security_workspace_isolation
  persona: reviewer
  q: "How do we ensure workspace isolation?"
  expected:
    must_include_types: ["constraint"]

# PERFORMANCE

- id: perf_n_plus_one
  persona: reviewer
  q: "Do we have any N+1 query risks?"
  expected:
    should_include_keywords: ["N+1"]

- id: perf_hybrid_search
  persona: architect
  q: "How is hybrid search ranked?"
  expected:
    should_include_keywords: ["vector", "fts", "boost"]

# POLICY

- id: policy_global_vs_project
  persona: architect
  q: "When should we use global rules vs project rules?"
  expected:
    must_include_fields: ["global"]

- id: policy_oidc_vs_github
  persona: architect
  q: "What is the difference between OIDC gate and GitHub authority?"
  expected:
    should_include_keywords: ["oidc", "github"]

# MONOREPO / SUBPATH

- id: monorepo_subpath_behavior
  persona: neutral
  q: "If I work in apps/admin-ui, will context mix with other apps?"
  expected:
    should_include_keywords: ["subpath"]

- id: monorepo_auto_split
  persona: architect
  q: "What happens in split_auto mode?"
  expected:
    should_include_keywords: ["split_auto"]

# EDGE / FAILURE CASES

- id: no_decision_data
  persona: neutral
  q: "What happens if there are no decisions stored?"
  expected:
    must_not_include_types: ["decision"]

- id: persona_difference
  persona: reviewer
  q: "Review this architecture for risks."
  expected:
    should_include_types: ["constraint"]
